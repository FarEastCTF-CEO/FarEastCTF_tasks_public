from cryptography.hazmat.backends import default_backend
from cryptography.hazmat.primitives import serialization
from cryptography.hazmat.primitives.asymmetric import rsa

e = 30749686305802061816334591167284030734478031427751495527922388099381921172620569310945418007467306454160014597828390709770861577479329793948103408489494025272834473555854835044153374978554414416305012267643957838998648651100705446875979573675767605387333733876537528353237076626094553367977134079292593746416875606876735717905892280664538346000950343671655257046364067221469807138232820446015769882472160551840052921930357988334306659120253114790638496480092361951536576427295789429197483597859657977832368912534761100269065509351345050758943674651053419982561094432258103614830448382949765459939698951824447818497599
d = 4221909016509078129201801236879446760697885220928506696150646938237440992746683409881141451831939190609743447676525325543963362353923989076199470515758399
p = 346833078117004767934987152587133647434474297161417369159543075326927432680882058031442675506196435665025219376801086377035442415567634506375799494435093165430094291146094126228574765505565545507921243576702066613132332029400023943146974027979295578481488937303630614817486209376457065143064450479466239275481
q = 317057890181414469666040372874657888470518637636378992714996906808811767347698361825453788201655367013267374494850325311308704150787266971407342622878242861647297030974411657137399520160932470945499064402456059374085028709386054015305540485630054050704209243043242436773039716793288587265042228064198304717861
m = p*q

private_key = rsa.RSAPrivateNumbers(
    p=p,
    q=q,
    d=d,
    dmp1=d % (p - 1),
    dmq1=d % (q - 1),
    iqmp=pow(q, -1, p),
    public_numbers=rsa.RSAPublicNumbers(e, m),
).private_key(default_backend())

# Получение открытого ключа из закрытого
public_key = private_key.public_key()

# Получение закрытого ключа в формате PEM
private_key_pem = private_key.private_bytes(
    encoding=serialization.Encoding.PEM,
    format=serialization.PrivateFormat.TraditionalOpenSSL,
    encryption_algorithm=serialization.NoEncryption()
).decode('utf-8')

# Получение открытого ключа в формате OpenSSH
public_key_openssh = public_key.public_bytes(
    encoding=serialization.Encoding.OpenSSH,
    format=serialization.PublicFormat.OpenSSH
).decode('utf-8')

print("Открытый ключ (public key):")
print(public_key_openssh)
print("\nЗакрытый ключ (private key):")
print(private_key_pem)
