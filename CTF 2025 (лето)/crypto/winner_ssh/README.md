# Crypto | winner_ssh

# Информация
Участнику выдаётся дамп трафика и образ виртуальной машины. В трафике перехватывается передача **открытого SSH‑ключа** пользователя `mike` на сервер (`10.0.0.5`) через `nc`.
Далее нужно извлечь параметры RSA (`e`, `n`) из открытого ключа, применить **атаку Винера** (слабый RSA с маленьким `d`) для восстановления `p`, `q`, `d`, сгенерировать закрытый ключ и зайти по SSH, чтобы забрать флаг.

Ожидаемые параметры окружения:
- Guest: `10.0.0.5` (статический адрес)
- SSH: `22/tcp`
- УЗ: `mike`
- Флаг находится в `/home/mike/readme`

# Деплой
1. Импортируйте `CTF.ova` в VirtualBox/VMware.
2. Настройте сеть так, чтобы ВМ была доступна по адресу `10.0.0.5` (например, Host‑Only сеть `10.0.0.0/24`).
3. Убедитесь, что с хоста доступен `10.0.0.5:22`.
4. (Опционально) добавьте запись `ctf-server -> 10.0.0.5` в DNS/hosts, если хотите использовать имя.

Как создавалась ситуация с ключом (для понимания/воспроизведения):
- на госте ключ кладётся в `/home/mike/.ssh/authorized_keys`
- приём ключа: `nc -lvp 12345 > /home/mike/.ssh/authorized_keys`
- отправка ключа с хоста: `solve/send_public_key.py`
- трафик записи: `public/traffic.pcapng`

# Выдать участникам
- `public/traffic.pcapng` (sha256: `877751c08df4db16374a156ca82c2bcab5042a52ff36ffeb0dd8ba2037067875`)
- `CTF.ova` 

# Описание для площадки
**winner_ssh**

Вам выдан дамп трафика `traffic.pcapng` и образ ВМ `CTF.ova`. В трафике передаётся открытый SSH‑ключ пользователя `mike` на сервер. Используя криптоанализ RSA (атака Винера на маленький `d`), восстановите закрытый ключ, подключитесь по SSH к `10.0.0.5` и найдите флаг.

# Флаг
FLAG{FhG3L4_2s9aY_87xTq_1nM5b_6pUoP}
