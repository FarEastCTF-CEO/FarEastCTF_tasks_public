# Write-up: LoV3 Japan

## 1. Осмотр файла

Участникам выдают `LoV3_Japan.jpg`.

Если открыть картинку, видно «японский кроссворд» (nonogram), а в EXIF есть подсказка про программу **Cross+A**.

Дальше стоит проверить, нет ли в JPEG лишних данных (частая стего-техника — дописать данные после маркера конца JPEG `FFD9`).

## 2. Извлечение спрятанного архива

Найдём сигнатуру ZIP в конце файла:

```bash
xxd -g 1 LoV3_Japan.jpg | grep -n "50 4b 03 04" | head
# или
binwalk LoV3_Japan.jpg
```

В файле после конца JPEG лежит ZIP-архив. Его можно вырезать любым способом:

**Вариант 1 (binwalk):**
```bash
binwalk -e LoV3_Japan.jpg
```

**Вариант 2 (dd):**
```bash
# PK\x03\x04 начинается с оффсета 352689
dd if=LoV3_Japan.jpg of=hidden.zip bs=1 skip=352689 status=none
unzip hidden.zip
```

Внутри архива находится файл:

- `qr_code.jcp`

## 3. Решение кроссворда и получение флага

`*.jcp` — формат японских кроссвордов, который открывается в **Cross+A** (и в ряде других решателей nonogram).

1. Открываем `qr_code.jcp` в Cross+A.
2. Решаем кроссворд (можно вручную или автосолвером).
3. По итогу получается QR-код.
4. Сканируем QR-код любым сканером → получаем флаг.

Флаг:

```
SplitCTF{с0untry_r1s1ng_sun}
```

> Важно: первая буква `с` — **кириллическая** (U+0441), а не латинская `c`.
