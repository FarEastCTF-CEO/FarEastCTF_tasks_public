# forensics | Little Rat 2

# Информация
Участникам дан журнал security событий Windows, `little_rat.evtx`.

Пейлод написан так, чтобы скрыть реальные действия среди мусорных событий: на 1-7 реальные команды приходится ~28 мусорных (whoami, netstat и т.д.).

Фактически имеется 2 массива строк, один с открытыми для cmd, второй в base64 для powershell. Атакующие строки хранятся в base64 и вызываются с powershell.

Плотный стек событий `4688` и `4689` сложно не заметить, а как выяснилось после сбора лога, в нем еще и легко потеряться.
За начало этой атаки берется событие 4688 с echo фальшивого флага, сделано специально чтобы привлечь внимание.

Ключевое событие для решения — ID 4688 (A new process has been created) с командной строкой,
содержащей вызов `curl`, находится примерно в середине стека событий атаки.

Найти его можно просто перебором этого стека, ибо спустя несколько событий от изначального вызова powershell с base64 строкой, она засветилась в открытом виде.

Полное имя файла копии дампа с расширением, в который он был перенесен при установке и теперь отправлен на файлообменник, является флагом.

# Выдать участникам
`little_rat.evtx`

# Описание для площадки
Паркер! Как успехи с прошлой задачей? А не важно, видимо эти жулики не остановились! Пока ты копался с лицензиями, у части отдела начали тормозить компьютеры! Я хочу, чтобы ты перерыл эти логи еще раз и нашёл, ради чего они это делают! И не вздумай говорить, что это невозможно! Я плачу тебе за невозможное!

Формат флага: FECTF{filename.ext}

# Флаг
`FECTF{YouDidn'tSeeMe.meow}`
